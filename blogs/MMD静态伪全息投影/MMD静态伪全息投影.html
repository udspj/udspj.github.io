<!DOCTYPE html>
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>MMD静态伪全息投影</title>

<xmp theme="simplex" style="display:none;">

就是这种透明四棱锥小盒子，虽然叫“全息投影盒”，但本质不是全息。

这种特殊视频种类并不是很多，所以搞个网页把mmd渲染出来直接播放

http://udspj.github.io/minigame/mmddemo/

（现在只搞了不会动的模型）

![mahua](imgs/a.jpeg)

![mahua](imgs/b.jpeg)

##MMD解析

直接用第三方库mmd-parser.js解析，我用来做demo的是pmx文件格式。

关于pmx和pmd有啥区别，有个视频https://www.youtube.com/watch?v=1MEqAfSTAXE

解析出来是下面格式，因为现阶段只做到最基本的渲染静态模型，所以下图里只需要用到红圈圈出来的这些数据。

![mahua](imgs/1.png)

![mahua](imgs/2.png)

![mahua](imgs/3.png)

![mahua](imgs/4.png)

渲染这个的思路跟入门教程里的小方块一样的，只不过模型数据多一些而已。

三件套：坐标、贴图uv、索引。normal可以先不用，这个跟光有关。

faces就是索引，把indices、positions、uv全取出来各自整合到一起，materials原封不动整个取出。

##静态模型渲染

跟那些入门教程立方体一样的渲染方式，区别就只是materials里把模型拆分成26个部分，需要分别渲染26次。

每个部分里有对应texture纹理图片索引编号，编号跟textures数组对应的；还有根据faceCount表示从faces数组里按顺序从前往后取对应数量的索引，注意这个faceCount指的是原始faces数组里indices数组的个数，因为之前已经把indices全部取出整合到一起，所以实际在取faceCount时要乘以3。

关于GLSL，立方体例子是怎么用的就直接套过来用。

##复制成四个面

这里用到《WebGL编程指南》附带源码里的Matrix库。

html上弄4个canvas，在各自canvas上渲染一个模型，利用Matrix调整位置、旋转，做出模型的4个面。

</xmp>

<script src="http://strapdownjs.com/v/0.2/strapdown.js"></script>
</html>